<div id="BackGround" class="ImageLogin">
</div>
<div class="PageConnexion">

  <div class="card card-login mx-auto mt-5">
    <div class="card-header">
      <h3 class="text-center">Connexion</h3>
    </div>
    <div class="card-body">
      <form>
        <div id="ListeEmploye"></div>
        <br>
        <div class="form-label-group">
          <input type="password" name="inputPassword" id="inputPassword" class="form-control" placeholder="Mot de passe" minlength="5" required="required">
          <small id="wrongpassword" style="color:red" class="form-text text-hide">Non, je suis sûr que ce n'est pas le bon, essaie encore ¯\_(ツ)_/¯</small>
        </div>
        <br>
        <button class="btn btn-primary btn-block" id="Log">Connexion</button>
      </form>
      <div class="text-center">
        <hr>
        <a class="d-block small mt-3" id="target" style="color:DodgerBlue; cursor:pointer">
          <u>Je n'apparais pas dans la liste..</u>
        </a>
      </div>
    </div>
  </div>
</div>
<div id="ModalLogin" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">World 1 - Level 1</h4>
      </div>
      <div class="modal-body">
        <p>
          N'apparait dans la liste que les ressources qui :
          <li>Sont enregistrées dans la base de données</li>
          <li>Sont définies en tant qu'actifs</li>
          Si ce n'est pas ton cas, un Scrum Master peux résoudre ça.
        </p>
        
        <img src="https://i.imgflip.com/2wxesf.jpg" width="100%"></img>
      </div>
    </div>
  </div>
</div>

<script>
  
  $(document).ready(function () {

    //Load all employes
    RequeteAjax('ListeEmploye', 'ListeDeroulanteEmployeActif', 'Modele/RequetesAjax.php')

    //Show modal if click on help
    $("#target").click(function () {
      $('#ModalLogin').modal('show');
    });

    //Lors du click sur connexion
    $('#Log').click(function () {

      $.ajax({
          url: "Modele/ConnectionLogin.php",
          method: "POST",
          dataType: "json",
          data: {
            inputPassword: $('#inputPassword').val(),
            TypeEmployeOk: $('#TypeEmployeOk').val()
          },
          success: function (data) {
            if(data.Connexion){
              localStorage.setItem('Connexion', $('#TypeEmployeOk').val())
              location.reload();
            }else{
              $( "#wrongpassword" ).removeClass( "text-hide" );
              $( "#inputPassword" ).addClass("is-invalid").effect( "shake" );
            }
          }
        });
      });

    //Preload users if ID is save in the local storage
    if (localStorage.getItem("Connexion")) {
      $('#TypeEmployeOk option[value="' + localStorage.getItem("Connexion") + '"]').attr('selected', 'selected');
    }

  });
</script>